import psycopg2
from psycopg2 import sql

def create_items_table():
    # Connect to PostgreSQL (adjust parameters accordingly)
    conn = psycopg2.connect(
        dbname='event_planner_db', user='postgres', password='postgres', host='localhost', port='5432'
    )
    cur = conn.cursor()

    # Create table
    create_table_query = '''
    CREATE TABLE IF NOT EXISTS items_table (
        id SERIAL PRIMARY KEY,
        name TEXT NOT NULL,
        category_id INTEGER NOT NULL,
        category_name TEXT NOT NULL,
        subcategory_id INTEGER,
        subcategory_name TEXT,
        item_types TEXT[]
    );
    '''
    cur.execute(create_table_query)
    conn.commit()
    print("Table 'items_table' created successfully.")

    # Define categories, subcategories, and items
    categories = {
        1: ("Инструменти", {
            1: ("Ударни", {"Бубњеви": [], "Тапан": [], "Конги": [], "Тарабука": []}),
            2: ("Жичани", {"Гитара": [], "Бас Гитара": [], "Виолина": [], "Виолончело": [], "Контрабас": [], "Харфа": []}),
            3: ("Клавијатура", {"Хармоника": [], "Синтисајзер": [], "Пијано": []}),
            4: ("Дувачки", {"Труба": [], "Флејта": [], "Кларинет": [], "Саксофон": [], "Гајда": [], "Зурла": []}),
        }),
        2: ("Угостителство", {None: {"Бармен": [], "Келнер": [], "Готвач": []}}),
        3: ("Кетеринг", {
            1: ("Кетеринг Инвертар", {
                "Чаши": ["Стакло", "Пластика", "Хартија", "Стиропор", "Еко"],
                "Тањири": ["Порцелан", "Стакло", "Алуминиум", "Пластика", "Хартија", "Стиропор", "Еко"],
                "Прибор": ["Метал", "Дрво", "Пластика", "Еко"],
                "Чаршаф": ["Црн", "Бел", "Златен", "Сребрен", "Боја"]
        }),
            2: ("Кетеринг Услуги", {"Прилог храна": [], "Камиони за храна": [], "Машинa за сладолед": [], "Машина за пуканки": [], "Машина за шеќерна волна": [], "Фонтани за чоколадо": []}),
        }),
        4: ("Монтажна Опрема", {
            1: ("Озвучување", {"Микрофон": [], "Звучник": ["Мал", "Голем"], "Миксета": []}),
            2: ("Видео", {"Камера": [], "Проектор": [], "LED дисплеј": []}),
            3: ("Осветлување", {"Рефлектор": [], "LED панел": [], "Ласер": []}),
            4: ("Структури", {"Платформа": [], "Шатор": [], "Подиум": [], "Бекдроп": [], "Барикади": [], "Надстрешница": [], "Фото Кабина": [], "Пренослив тоалет": []}),
        }),
        5: ("Мебел", {None: {"Маса": [], "Барска маса": [], "Клуб маса": [], "Стол": [], "Барски стол": [], "Сепаре стол": [], "Клупа": [], "Песочна вреќа": []}}),
        6: ("Декорации", {None: {"Балони": [], "Реквизити": [], "Цветови": ["Природни", "Вештачки"]}}),
        7: ("Изведувачи", {None: {"Пејач": [], "Бенд": ["Поп", "Рок", "Метал", "Џез", "Народно"], "Диџеј": [], "Хор": [], "Танцувачи": ["Хип Хоп", "Балет"], "Играорци": [], "Мажоретки": []}}),
        8: ("Транспорт", {None: {"Автомобил": [], "Лимузина": [], "Патничко Комбе": [], "Автобус": [], "Товарно Возило": [], "Пајтон": []}}),
        9: ("Рекламни Услуги", {None: {"Флаери": [], "Банери": [], "Онлајн маркетинг": [], "Брендирани подароци": []}}),
        10: ("Фото и Видео Сервиси", {None: {"Фотограф": [], "Камерман": [], "Дрон камера": []}}),
        11: ("Модна Промоција", {None: {"Стилист": [], "Шминкер": [], "Фризер": []}}),
        12: ("Техничка Поддршка", {None: {"Аудио Техничар": [], "Видео Tехничар": [], "Инсталатер": [], "Електричар": [], "Агрегат": ["<10MW", "10-100MW", "100+MW"]}}),
        13: ("Безбедносна Поддршка", {None: {"Обезбедување": ["Лично", "Објект"], "Надзорна опрема": [], "Системи за контрола на влез": [], "Медицински тим": [], "ППЕ Апарат": []}}),
        14: ("Забавни Активности", {
            1: ("Спорски Реквизити", {"Топка": ["Фудбал", "Кошарка", "Тенис"], "Гол": [], "Кош": [], "Мрежа": ["Тенис"]}),
            2: ("Театар", {"Комедијант": [], "Детски аниматор": ["Херој", "Цртан Филм", "Кловн"], "Куклена претстава": []}),
            3: ("Интерактивни услуги", {"VR/AR Кабина": [], "Интерактивен панел": [], "Тркачки симулатор": []}),
        }),
    }

    # Insert items into the table
    insert_query = '''
    INSERT INTO items_table (name, category_id, category_name, subcategory_id, subcategory_name, item_types)
    VALUES (%s, %s, %s, %s, %s, %s);
    '''

    for cat_id, (cat_name, subcats) in categories.items():
        for sub_id, sub_data in subcats.items():
            sub_name = sub_data[0] if isinstance(sub_data, tuple) else None
            items = sub_data[1] if isinstance(sub_data, tuple) else sub_data
            for item, types in items.items():
                cur.execute(insert_query, (item, cat_id, cat_name, sub_id, sub_name, types))

    conn.commit()
    cur.close()
    conn.close()
    print("Items inserted successfully.")

if __name__ == "__main__":
    create_items_table()
